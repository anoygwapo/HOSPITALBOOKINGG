<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Patient Dashboard | HospitalCare</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#eaf6ff;
      --card:#ffffff;
      --muted:#6b7280;
      --primary-600:#0466c8;
      --accent:#00b4d8;
      --success:#2bb673;
      --warning:#f6b24a;
      --danger:#e04848;
      --radius-lg:16px;
      --radius-md:10px;
      --shadow-soft: 0 10px 30px rgba(13, 50, 94, 0.06);
      --shadow-sm: 0 6px 18px rgba(13,50,94,0.06);
      --max-width:1200px;
    }

    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; -webkit-font-smoothing:antialiased}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#f7fbff);color:#0b2236}
    a{color:inherit}

    /* Header */
    header{
      max-width:var(--max-width);
      margin:28px auto;
      padding:26px 22px;
      background:linear-gradient(135deg,var(--primary-600),var(--accent));
      border-radius:18px;
      color:#fff;
      box-shadow:var(--shadow-soft);
      position:relative;
      overflow:visible;
    }
    header .wrap{display:flex;gap:18px;align-items:center}
    header .brand{
      display:flex;gap:14px;align-items:center;
    }
    header h1{margin:0;font-size:1.25rem;font-weight:700;letter-spacing:0.2px}
    header p{margin:2px 0 0 0;opacity:.95;font-weight:500;font-size:.95rem}

    .profile-pic{
      width:120px;height:120px;border-radius:50%;border:5px solid rgba(255,255,255,0.14);
      background-image:url('https://cdn-icons-png.flaticon.com/512/149/149071.png');
      background-size:cover;background-position:center;
      position:absolute;left:50%;transform:translateX(-50%);bottom:-60px;box-shadow:var(--shadow-sm);
    }

    /* Layout */
    main{max-width:var(--max-width);margin:84px auto 40px;padding:0 20px;display:grid;grid-template-columns:320px 1fr;gap:24px;align-items:start}
    @media (max-width:980px){ main{grid-template-columns:1fr; padding:0 16px} header{margin:18px 12px} .profile-pic{left:calc(100% - 86px); transform:none; bottom: -56px} }

    /* Card */
    .card{background:var(--card);border-radius:var(--radius-lg);padding:18px;box-shadow:var(--shadow-sm)}
    .card h2{margin:0 0 12px 0;color:var(--primary-600);font-size:1.1rem;padding-left:10px;border-left:4px solid var(--primary-600)}

    /* Sidebar */
    .sidebar .me{
      text-align:center;padding:18px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfdff);border:1px solid rgba(6,78,163,0.04)
    }
    .avatar{width:96px;height:96px;border-radius:50%;margin:0 auto 10px;background-image:url('https://cdn-icons-png.flaticon.com/512/149/149071.png');background-size:cover;background-position:center;border:6px solid #fff;box-shadow:0 6px 18px rgba(4,99,177,0.08)}
    .me h3{margin:6px 0 0 0;font-size:1rem}
    .me p{margin:6px 0 0 0;color:var(--muted);font-size:0.9rem}

    .info-list{margin-top:12px;display:grid;gap:10px}
    .info{background:linear-gradient(180deg,#f6fbff,#ffffff);padding:10px;border-radius:10px;border:1px solid rgba(6,78,163,0.06);font-size:0.95rem;display:flex;justify-content:space-between;align-items:center}
    .info strong{color:var(--primary-600)}

    .btn{display:inline-block;width:100%;text-align:center;padding:12px 14px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--primary-600));color:#fff;font-weight:700;text-decoration:none;margin-top:12px;box-shadow:0 8px 26px rgba(0,180,216,0.12)}
    .logout{text-decoration:none;color:var(--muted);display:block;margin-top:10px;text-align:center}
    .logout:hover{color:var(--danger)}

    /* Main content */
    .main-content{display:flex;flex-direction:column;gap:20px}

    /* Stats row */
    .stats{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .stat{padding:14px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfdff);border:1px solid rgba(6,78,163,0.04);text-align:left}
    .stat .num{font-size:1.25rem;font-weight:800;color:var(--primary-600)}
    .stat .label{font-size:0.9rem;color:var(--muted);margin-top:6px}
    @media (max-width:700px){ .stats{grid-template-columns:repeat(2,1fr)} }

    /* Appointments */
    .appointments .list{display:flex;flex-direction:column;gap:12px;margin-top:8px}
    .appt{display:grid;grid-template-columns:56px 1fr auto;gap:12px;align-items:center;padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fbfdff);border:1px solid rgba(6,78,163,0.04)}
    .appt .icon{width:56px;height:56px;border-radius:10px;background:#e8f6ff;color:var(--primary-600);display:flex;align-items:center;justify-content:center;font-weight:700}
    .appt .details strong{display:block;color:#0b355a;margin-bottom:6px}
    .appt .meta{color:var(--muted);font-size:0.92rem}
    .pill{padding:6px 10px;border-radius:999px;font-weight:700;font-size:0.85rem}
    .pill.approved{background:rgba(43,182,115,0.12);color:var(--success)}
    .pill.pending{background:rgba(246,178,74,0.08);color:var(--warning)}
    .pill.declined{background:rgba(224,72,72,0.08);color:var(--danger)}
    .appt a.view{display:inline-block;background:transparent;border:1px solid rgba(6,78,163,0.08);padding:8px 10px;border-radius:8px;color:var(--primary-600);text-decoration:none;font-weight:600;margin-left:8px}

    /* Doctors */
    .doctor-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px;margin-top:10px}
    .doctor{padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfdff);border:1px solid rgba(6,78,163,0.04);display:flex;gap:12px;align-items:center}
    .doc-avatar{width:64px;height:64px;border-radius:12px;background:#e8f6ff;display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--primary-600;font-size:1.25rem)}
    .doc .meta{flex:1}
    .doc .meta strong{display:block;color:#063a6b}
    .doc small{display:block;color:var(--muted);margin-top:6px}
    .doc .actions{display:flex;flex-direction:column;gap:8px}
    .btn-sm{padding:8px 10px;border-radius:10px;background:linear-gradient(90deg,var(--primary-600),var(--accent));color:#fff;text-decoration:none;font-weight:700;text-align:center}

    /* Footer */
    footer{max-width:var(--max-width);margin:28px auto;padding:18px;background:transparent;text-align:center;color:var(--muted);font-size:0.9rem}

    /* Accessibility focus */
    a:focus, button:focus { outline:3px solid rgba(0,180,216,0.14); outline-offset:3px; border-radius:8px }
  </style>
</head>
<body>

  <header role="banner" aria-label="HospitalCare header">
    <div class="wrap">
      <div class="brand" style="gap:12px;">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="flex-shrink:0">
          <rect x="2" y="6" width="20" height="14" rx="2" stroke="rgba(255,255,255,0.9)" stroke-width="1.2" fill="none"/>
          <path d="M12 3v6" stroke="rgba(255,255,255,0.95)" stroke-width="1.4" stroke-linecap="round"/>
          <path d="M8 12h8" stroke="rgba(255,255,255,0.95)" stroke-width="1.2" stroke-linecap="round"/>
        </svg>
        <div>
          <h1>HospitalCare â€” Patient Dashboard</h1>
          <p>Quick access to your appointments, doctors and personal info</p>
        </div>
      </div>

      <div style="margin-left:auto;display:flex;gap:10px;align-items:center">
        <a class="btn" href="{{ url_for('book_appointment') }}" title="Book appointment">ðŸ“… Book Appointment</a>
      </div>
    </div>

    <div class="profile-pic" aria-hidden="true"></div>
  </header>

  <main>
    <!-- SIDEBAR -->
    <aside class="sidebar" aria-label="Sidebar">
      <div class="card me">
        <div class="avatar" role="img" aria-label="Profile image"></div>
        <h3>{{ user.fullname or 'Not Provided' }}</h3>
        <p>{{ user.email or '' }}</p>

        <div class="info-list" aria-hidden="false">
          <div class="info"><span>Contact</span><strong>{{ user.contact or 'â€”' }}</strong></div>
          <div class="info"><span>Address</span><strong>{{ user.address or 'â€”' }}</strong></div>
          <div class="info"><span>Member since</span><strong>{{ user.joined_at or 'â€”' }}</strong></div>
        </div>

        <a class="btn" href="{{ url_for('book_appointment') }}" style="margin-top:14px">ðŸ“… Book Appointment</a>
        <a href="{{ url_for('logout') }}" class="logout">Logout</a>
      </div>

      <div style="height:14px"></div>

      <div class="card">
        <h2>Emergency</h2>
        <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
          <div style="display:flex;justify-content:space-between"><div style="color:var(--muted)">Nurse Hotline</div><div style="font-weight:700">+1 (555) 123-4567</div></div>
          <div style="display:flex;justify-content:space-between"><div style="color:var(--muted)">Appointments</div><div style="font-weight:700">+1 (555) 987-6543</div></div>
        </div>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <section class="main-content" aria-label="Main content area">

      <div class="card">
        <div class="stats">
          <div class="stat">
            <div class="num">{{ stats.total_appointments if stats is defined else (appointments|length) }}</div>
            <div class="label">Total Appointments</div>
          </div>
          <div class="stat">
            <div class="num">{{ stats.upcoming if stats is defined else (appointments | selectattr('status','in',['Pending','Approved']) | list | length) }}</div>
            <div class="label">Upcoming</div>
          </div>
          <div class="stat">
            <div class="num">{{ stats.completed if stats is defined else 0 }}</div>
            <div class="label">Completed</div>
          </div>
        </div>
      </div>

      <div class="card appointments" aria-labelledby="appt-heading">
        <h2 id="appt-heading">ðŸ“‹ My Appointment History</h2>
        <div class="list" role="list">
          {% for appt in appointments %}
          <div class="appt" role="listitem" aria-label="Appointment with {{ appt.doctor.name }}">
            <div class="icon" aria-hidden="true" style="
    width:56px;
    height:56px;
    border-radius:10px;
    background-size:cover;
    background-position:center;
    background-image: url('{% if appt.doctor.photo %}{{ url_for('static', filename=appt.doctor.photo) }}{% else %}https://cdn-icons-png.flaticon.com/512/149/149071.png{% endif %}');
"></div>


            <div class="details">
              <div class="meta"><strong>{{ appt.doctor.name }}</strong> <span style="color:var(--muted);font-weight:600;font-size:0.95rem">({{ appt.doctor.specialization }})</span></div>
              <div class="meta">{{ appt.date }} â€¢ {{ appt.time }} â€¢ {{ appt.reason }}</div>
            </div>

            <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
              {% if appt.status == 'Approved' %}
                <span class="pill approved">Approved</span>
              {% elif appt.status == 'Pending' %}
                <span class="pill pending">Pending</span>
              {% else %}
                <span class="pill declined">{{ appt.status }}</span>
              {% endif %}
              <a class="view" href="{{ url_for('view_appointment', id=appt.id) }}">View</a>
            </div>
          </div>
          {% else %}
          <p style="color:var(--muted);margin:8px 0">You don't have any appointments yet. Use the Book button to schedule one.</p>
          {% endfor %}
        </div>
      </div>

      <div class="card doctors" aria-labelledby="doctors-heading">
        <h2 id="doctors-heading">ðŸ©º Available Doctors</h2>
        <div class="doctor-grid">
          {% for doc in doctors %}
          <div class="doctor" role="article" aria-label="{{ doc.name }} â€” {{ doc.specialization }}">
            <div class="doc-avatar" aria-hidden="true"
     style="
       {% if doc.photo %}
         background-image: url('{{ url_for('static', filename=doc.photo) }}');
       {% else %}
         background-image: url('https://cdn-icons-png.flaticon.com/512/149/149071.png');
       {% endif %}
       background-size: cover;
       background-position: center;
     ">
</div>

            <div class="meta">
              <strong>{{ doc.name }}</strong>
              <small>{{ doc.specialization }} â€¢ {{ doc.schedule }}</small>
            </div>
            <div class="actions">
              <a class="btn-sm" href="{{ url_for('book_appointment') }}">Book</a>
            </div>
          </div>
          {% else %}
          <p style="color:var(--muted);margin:8px 0">No doctors available at the moment.</p>
          {% endfor %}
        </div>
      </div>

    </section>
  </main>

  <footer>
    Â© 2025 HospitalCare â€” All rights reserved
  </footer>

</body>
</html>