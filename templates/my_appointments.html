<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Appointments - PetClinic</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #3a8dde;
    --primary-dark: #245a90;
    --sidebar-bg: #eff6fb;
    --header-bg: #3a8dde;
    --header-txt: #fff;
    --section-bg: #f7fafd;
    --border: #e2e9f3;
    --success: #33b977;
    --warn: #f1b807;
    --err: #df5353;
    --radius: 16px;
    --shadow: 0 2px 16px 0 rgba(41,117,196,0.08), 0 1.5px 10px #b2d4fa10;
  }
  body {
    font-family: 'Poppins',sans-serif;
    background: var(--sidebar-bg);
    margin: 0;
    min-height: 100vh;
  }

  .header {
    background: var(--header-bg);
    color: var(--header-txt);
    padding: 24px 0;
    text-align: center;
    font-size: 2rem;
    font-weight: 700;
    letter-spacing: .5px;
    box-shadow: 0 4px 18px #bde0fa3a;
    border-bottom: 3px solid #2975b7;
    margin-bottom: 38px;
  }

  .hospital-container {
    display: flex;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 15px 38px 15px;
    gap:32px;
  }

  .sidebar {
    flex: 0 0 240px;
    background: var(--sidebar-bg);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 30px 20px 20px 20px;
    min-height: 360px;
    margin-top: 18px;
    border: 1.5px solid var(--border);
    display:flex;
    flex-direction:column;
    align-items:center;
    gap: 18px;
    max-height: 680px;
  }
  .sidebar .avatar {
    width: 70px; height: 70px;
    border-radius: 50%; background: #96bbea;
    display: flex; align-items: center; justify-content: center;
    font-size:2.5rem; color:#fff; font-weight: 700; margin-bottom:7px;
    box-shadow: 0 2px 16px #c4e8ff56;
  }
  .sidebar h3 { margin: 0 0 8px 0; font-weight:700; color:var(--primary-dark); }
  .sidebar .sidebar-section {
    width:100%; padding:10px 0; border-bottom:1px solid var(--border);
    margin-bottom:6px; color:#2d3b48; font-size:1.09rem;
    text-align:center;
  }
  .sidebar .sidebar-section:last-child{ border-bottom:none;}
  .sidebar .logout-link {
    background: transparent; color: #ef476f; margin-top:12px; font-weight: 600; font-size:1rem; border:none; cursor:pointer;
  }
  .sidebar .logout-link:hover{ text-decoration:underline;}

  .main-content {
    flex: 1;
  }

  .appointment-list-area {
    background: var(--section-bg);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    border: 1.5px solid var(--border);
    padding: 35px 36px 30px 36px;
  }

  .section-title {
    color: var(--primary-dark);
    font-size: 1.42rem;
    font-weight: 700;
    margin: 0 0 27px 0;
    letter-spacing: .5px;
    border-left: 4px solid var(--primary);
    padding-left: 18px;
  }

  .appointments-table {
    width: 100%;
    border-collapse:separate;
    border-spacing:0;
    background: #fff;
    margin-bottom: 0;
    box-shadow: 0 4px 14px #e2e9f221;
    border-radius:12px;
    overflow: hidden;
  }
  .appointments-table th, .appointments-table td {
    padding: 14px 14px 14px 0;
    text-align: left;
    border-bottom: 1px solid #f2f2f2;
  }
  .appointments-table th {
    background: var(--sidebar-bg);
    color: #245a90;
    font-weight: 700;
    font-size: 1.05em;
    letter-spacing:.06em;
  }
  .appointments-table tr:last-child td {
    border-bottom: none;
  }
  .appointments-table td {
    font-size: 1.07em;
    color: #344054;
  }
  .appointments-table td strong { color: var(--primary);}
  .appointments-table .status-pending {
    color: var(--warn); font-weight:700; background: #fffbe2; border-radius:6px; padding:4px 9px;
  }
  .appointments-table .status-approved {
    color: var(--success); font-weight:700; background: #e6fbe9; border-radius:6px; padding:4px 9px;
  }
  .appointments-table .status-declined {
    color: var(--err); font-weight:700; background: #ffeaea; border-radius:6px; padding:4px 9px;
  }
  .btn, .cancel-btn {
    border-radius: 28px;
    text-decoration: none;
    font-weight: 600;
    font-size:1rem;
    padding: 7px 26px;
    border: none;
    background: linear-gradient(90deg, var(--primary), var(--primary-dark));
    color: white;
    transition: background 0.22s, box-shadow .12s;
    box-shadow: 0 1.5px 8px #b7dfff17;
    cursor:pointer;
    outline: none;
    display:inline-block;
  }
  .btn:hover, .cancel-btn:hover {
    background: linear-gradient(90deg, var(--primary-dark) 10%, #1b3051 90%);
  }
  .cancel-btn {
    background: linear-gradient(90deg,#e24b40,#c97733);
    margin-left: 0;
  }
  .cancel-btn:hover { background:linear-gradient(90deg,#ad382e,#ad7920); }
  .locked {
    color: #bcbcbc;
    font-weight:600;
    font-size:0.98em;
    margin-top:8px;
    display:inline-block;
  }
  .no-appointments {
    background: #fffdfd;
    padding: 58px 32px 45px 32px;
    border-radius: 17px;
    box-shadow: var(--shadow);
    color: #7e869d;
    font-size: 1.15rem;
    text-align: center;
    margin-top: 34px;
  }
  .no-appointments .btn {
    margin-top: 32px;
    font-size:1.13rem;
    padding:13px 38px;
  }
  @media (max-width: 1000px) {
    .hospital-container { flex-direction: column; gap:24px;}
    .sidebar { width:100%; max-width:340px; margin:0 auto 18px auto;}
    .main-content, .appointment-list-area{padding-left:7vw; padding-right:7vw;}
  }
  @media (max-width: 720px) {
    .appointment-list-area {padding:20px 5vw;}
    .sidebar {max-width:95vw;}
    .section-title{padding-left:7px;font-size:1.13rem;}
    .main-content, .appointment-list-area {padding:0;}
  }
  @media (max-width: 490px) {
    .header{font-size:1.1rem;padding:13px;}
    .section-title { font-size:0.99rem;padding-left:5px;}
    .appointment-list-area {padding:2vw;}
    .appointments-table th, .appointments-table td{font-size:0.93em;}
  }
</style>
</head>
<body>
  <div class="header">
    PetClinic &mdash; My Appointments
  </div>

  <div class="hospital-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="avatar">
        {{ (user.fullname[0] if user and user.fullname) | default('U') }}
      </div>
      <h3>{{ user.fullname }}</h3>
      <div class="sidebar-section">{{ user.email }}</div>
      <div class="sidebar-section">Contact: {{ user.contact or 'Not provided' }}</div>
      <div class="sidebar-section">Address: {{ user.address or 'Not provided' }}</div>
      <button class="logout-link" onclick="location.href='{{ url_for('logout') }}'">Logout</button>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
      <div class="appointment-list-area">
        <div class="section-title">Your Appointment Schedule</div>
        {% if appointments %}
        <table class="appointments-table">
          <thead>
            <tr>
              <th>Doctor</th>
              <th>Patient</th>
              <th>Date</th>
              <th>Time</th>
              <th>Reason</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for a in appointments %}
            <tr>
              <td><strong>{{ a.doctor.name }}</strong>
                  <br><small style="opacity:.7;">({{ a.doctor.specialty }})</small>
              </td>
              <td>{{ a.name }}</td>
              <td>{{ a.date }}</td>
              <td>{{ a.time }}</td>
              <td>{{ a.reason or "-" }}</td>
              <td>
                {% if a.status == "Pending" %}
                  <span class="status-pending">Pending</span>
                {% elif a.status == "Approved" %}
                  <span class="status-approved">Approved</span>
                {% else %}
                  <span class="status-declined">Declined</span>
                {% endif %}
              </td>
              <td>
                {% if a.status == 'Pending' %}
                  <a href="{{ url_for('cancel_appointment', id=a.id) }}" class="btn cancel-btn">Cancel</a>
                {% else %}
                  <span class="locked">Locked</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% else %}
        <div class="no-appointments">
          <p>You currently have no appointments scheduled.</p>
          <a class="btn" href="{{ url_for('book_appointment') }}">Book Appointment</a>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</body>
</html>
